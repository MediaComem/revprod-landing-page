<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <title><%= title %></title>

    <!-- Bootstrap CSS & icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css"
    />

    <style>
      /*!
      * Start Bootstrap - Business Frontpage v5.0.7 (https://startbootstrap.com/template/business-frontpage)
      * Copyright 2013-2021 Start Bootstrap
      * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-business-frontpage/blob/master/LICENSE)
      */
      .feature {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        height: 4rem;
        width: 4rem;
        font-size: 2rem;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container px-5">
        <a class="navbar-brand" href="/">
          <i class="bi bi-diamond-half me-2"></i>
          <%= title %>
        </a>
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="<%= backendBaseUrl %>/share">Share</a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Header -->
    <header class="bg-dark py-5">
      <div class="container px-5">
        <div class="row gx-5 justify-content-center">
          <div class="col-lg-6">
            <div class="text-center my-5">
              <h1 class="display-5 fw-bolder text-white mb-2">
                <i class="bi bi-diamond-half"></i>
                <%= title %>
              </h1>
              <p class="lead text-white-50 mb-4">
                Enabling holistic convergence & dynamically productizing
                resource-maximizing paradigms.
              </p>
              <div class="d-grid gap-3 d-sm-flex justify-content-sm-center">
                <a
                  class="btn btn-primary btn-lg px-4 me-sm-3"
                  href="<%= backendBaseUrl %>/donate"
                >
                  Share your experience!
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Activities -->
    <section class="py-5 border-bottom" id="features">
      <div class="container px-5 my-5">
        <div class="row gx-5">
          <div class="col-lg-4 mb-5 mb-lg-0">
            <div
              class="feature bg-primary bg-gradient text-white rounded-3 mb-3"
            >
              <i class="bi bi-shield-check"></i>
            </div>
            <h2 class="h4 fw-bolder">
              Reintermediate Transparent Deliverables
            </h2>
            <p>
              Leverage agile frameworks to provide a robust synopsis for high
              level overviews. Iterative approaches to corporate strategy foster
              collaborative thinking to further the overall value proposition.
              Organically grow the holistic world view of disruptive innovation
              via workplace diversity and empowerment.
            </p>
          </div>
          <div class="col-lg-4 mb-5 mb-lg-0">
            <div
              class="feature bg-primary bg-gradient text-white rounded-3 mb-3"
            >
              <i class="bi bi-bandaid"></i>
            </div>
            <h2 class="h4 fw-bolder">Brand Wireless Channels</h2>
            <p>
              Bring to the table win-win survival strategies to ensure proactive
              domination. At the end of the day, going forward, a new normal
              that has evolved from generation X is on the runway heading
              towards a streamlined cloud solution. User generated content in
              real-time will have multiple touchpoints for offshoring.
            </p>
          </div>
          <div class="col-lg-4">
            <div
              class="feature bg-primary bg-gradient text-white rounded-3 mb-3"
            >
              <i class="bi bi-brightness-high"></i>
            </div>
            <h2 class="h4 fw-bolder">Aggregate Back-end Systems</h2>
            <p>
              Capitalize on low hanging fruit to identify a ballpark value added
              activity to beta test. Override the digital divide with additional
              clickthroughs from DevOps. Nanotechnology immersion along the
              information highway will close the loop on focusing solely on the
              bottom line.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Testimonials -->
    <section class="py-5 border-bottom">
      <div class="container px-5 my-5 px-5">
        <div class="text-center mb-5">
          <h2 class="fw-bolder">Testimonials</h2>
          <p class="lead mb-0">From customers who love our product</p>
          <div
            id="donations-spinner"
            class="spinner-border mt-3 text-primary"
            role="status"
          >
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
        <div class="row gx-5 justify-content-center">
          <div id="donations" class="col-lg-6">
            <div class="card mb-4 donation d-none">
              <div class="card-body p-4">
                <div class="d-flex">
                  <div class="flex-shrink-0">
                    <i
                      class="bi bi-chat-right-quote-fill text-primary fs-1"
                    ></i>
                  </div>
                  <div class="ms-4">
                    <p class="mb-1 text"></p>
                    <div class="small text-muted">
                      -
                      <strong class="donator"></strong>
                      on
                      <span class="date"></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="py-5 bg-dark">
      <div class="container px-5">
        <p class="m-0 text-center text-white">
          Copyright &copy; <%= title %> 2021
        </p>
      </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"></script>

    <!-- Luxon -->
    <script
      src="https://cdn.jsdelivr.net/npm/luxon@2.1.1/build/global/luxon.min.js"
      integrity="sha256-vSborW7X9FSJg4XLi1TpwZKTlbN2nP6lHhC0XCNrVwU="
      crossorigin="anonymous"
    ></script>

    <script>
      const DateTime = luxon.DateTime;

      const $donation = $('.donation');
      const $donations = $('#donations');
      const $donationsSpinner = $('#donations-spinner');

      const donationsUrl = '<%= backendBaseUrl %>/donations';
      Promise.resolve(donationsUrl)
        .then(fetchDonations)
        .then(displayDonations)
        .catch(showDonationsError);

      function fetchDonations(url) {
        const headers = new Headers();
        headers.append('Pragma', 'no-cache');
        headers.append('Cache-Control', 'no-cache');

        return fetch(url, {
          headers: headers
        }).then(res => res.json());
      }

      function displayDonations(donations) {
        $donationsSpinner.remove();

        if (donations.length === 0) {
          return $('<p class="text-center text-muted" />')
            .append($('<em />').text('No one has donated yet'))
            .appendTo($donations);
        }

        donations.filter(hasTestimonial).forEach(donation => {
          $donation
            .clone()
            .removeClass('d-none')
            .find('.text')
            .text(donation.testimonial)
            .end()
            .find('.donator')
            .text(donation.userName)
            .end()
            .find('.date')
            .text(
              DateTime.fromISO(donation.date).toLocaleString(
                DateTime.DATETIME_MED
              )
            )
            .end()
            .appendTo($donations);
        });
      }

      function showDonationsError(err) {
        $donationsSpinner.remove();

        console.warn('Could not fetch or display donations', err);

        $('<p class="text-center text-danger" />')
          .text(
            'The list of donations is not available at this time. Please try again later.'
          )
          .appendTo($donations);
      }

      function hasTestimonial(donation) {
        return (
          typeof donation.testimonial === 'string' &&
          donation.testimonial.trim().length >= 1
        );
      }
    </script>
  </body>
</html>
